VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "SampleDao"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

'====================================================================================================
'
' サンプル用Dao
'
'====================================================================================================
Implements IDataEntryDao


'====================================================================================================
' コンストラクタ
'====================================================================================================
Private Sub Class_Initialize()
End Sub


'====================================================================================================
' デストラクタ
'====================================================================================================
Private Sub Class_Terminate()
    Call IDataEntryDao_Disconnect
End Sub


'====================================================================================================
' DB接続
'----------------------------------------------------------------------------------------------------
' IN : setting 設定
'====================================================================================================
Public Sub IDataEntryDao_Connect(Setting As Setting)
End Sub


'====================================================================================================
' DB切断
'====================================================================================================
Public Sub IDataEntryDao_Disconnect()
End Sub


'====================================================================================================
' トランザクション開始
'====================================================================================================
Public Sub IDataEntryDao_BeginTrans()
    Debug.Print "DataEntrySampleDao.BeginTrans"
End Sub


'====================================================================================================
' コミット
'====================================================================================================
Public Sub IDataEntryDao_CommitTrans()
    Debug.Print "DataEntrySampleDao.CommitTrans"
End Sub


'====================================================================================================
' ロールバック
'====================================================================================================
Public Sub IDataEntryDao_RollbackTrans()
    Debug.Print "DataEntrySampleDao.RollbackTrans"
End Sub


'====================================================================================================
' クエリ実行
'----------------------------------------------------------------------------------------------------
' IN : query クエリ文字列
'====================================================================================================
Public Sub IDataEntryDao_Execute(query)
    Debug.Print "DataEntrySampleDao.Execute"
End Sub


'====================================================================================================
' 指定されたテーブルのカラム定義を取得します
'----------------------------------------------------------------------------------------------------
' IN : tableName テーブル名
' OUT: カラム定義リスト
'====================================================================================================
Public Function IDataEntryDao_GetColumnDefinitions(TableName As String) As Collection
    Dim i As Long
    Dim cd As ColumnDefinition
    Dim list As Collection
    Set list = New Collection

    For i = 0 To 50
        Set cd = New ColumnDefinition
        With cd
            .ColumnId = i
            .ColumnName = "col_" & i
            .Comments = "カラム" & i
            .DataType = "VARCHAR2"
            .DataLength = 10 * (i + 1)
            .IsNullable = "0"
            .IsPrimaryKey = "0"
        End With
        Call list.Add(cd)
    Next
    Set IDataEntryDao_GetColumnDefinitions = list
End Function


